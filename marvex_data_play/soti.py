import requests
from requests.auth import HTTPBasicAuth
import pandas as pd
import ast
import csv


# Headers = { "Authorization" : "Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNyc2Etb2FlcCIsImVuYyI6IkEyNTZDQkMtSFM1MTIiLCJraWQiOiJFMUIzRDc0NDY4MTUyNzE2MDY2NUI5NUExQ0Y2OTAzMzc5MDZBN0ZEIiwidHlwIjoiSldUIn0.wtp2Nd6VjxaYd1eGZi7wzwGX3ke436ZuydmyYGNE3uER7r1MPSY0JM_Sxe37EUwrwswoIBRKNBEczjht9x-xJpK-pIye4-rqxNzfTp3PBYCxVUhdmb9N-gHQS2H30KSZpTgJG75Nq-M6AQgSTYg4O-F5h4mbFtgLT1M4QWH_TJyD29RuHs5f9NOnfTApRylg3I_4rnjkZVVsvkvVLt649MH_HLNwRrIrTD2YuY9KDEDiK-GoAfY2riDMbZDXIh2LGE4urS5WYUWpVqP9XZmhTMypDVPztpCsptubAb5Ap46L1V59bCiWaBRGB7ujk3zrXf0uGGyaThpOk91S3ANgwg.Q1J--6LEQ5IPM_VWlM_glA.ceXh08uYm4jpjyMhBYGN6Dkrq9Y7ABqTj1-8CH8qdfF2WqNDL0cZZZUPWfoEas6bq-GTqccS9dxVzIXyk0RTUR863ZxkZNrgC9Q7jEhUqkjsQNIJsesScr_S_TagAOJW6Wt_zO6nhB46GUdOS3N0FiWV8St4oJrEXAMyYRmrotwlSTmkkGktQgBOrEIY64pKKTQ730VqCWbGRgSOQdku07lr7XWxJ6wdkEei0fkYFsco6oBM4gfUqm5xiqmXHbLxe74-0R8T2eQiCd7cYtVXImXUSGTiTRcgePAMR1HuPA-wFc-9_HdPIG3Zc7f0tbl8YJH3jFZErkGzUiJjJ9Iw4w4jNEShMSf7qrqFxpuOZjP6YUMHVlitwPv1WMV1RNfVuJzLUXSlbSsO6EGmJuzB_To2lSQ7CCcoKppdPdhr_kX6sVwmOr1SgM9x-n1nRGGbSewA2amgrUiNXSIzL3EA6LEg2gUXt-E1zX5CYGoMTwH0ht0JjE1eNcomw3LDKkSNmqPvZc3Apff3HRCTfVOZpp0DNPV4ujEGxcZ3P61jq-WAzxrHRSXrmj9fxKxXzJFU_jKp_u8I-9FAeJq8wTg7mhv3gzXtGwtTV3SRi7EhMXFwDmVn9x1Kf4Dnp4FSutoHaU2e_Ptid8uChMfHaoTA0Ry-H-Bb1gjIwvnu78fqe72nXE7ZcsI6PUx56EPlPuWf8FzKKyoxpFfzXoWOJiteqZI-8Ndqx07SafTTtSfB8Lwr7ThUfr2xjRbuLteApWfGKsevV0f1FtDkFrnnB1-diROnS-Hciyl_TDN779iFA5eOazDdv9LVpTVrLsdCCXUECibMV07Sgchinnp-fiD1qLTU0kCCfrk54YzTFH5tZZonPvMA4vEqMvd9JScO5mYti07BcvgCQ4d3OcxJy0PxSqZl_kwpRAG_WUUMsj_k3Fx2DGw2i0zhkw7H3nOE6WNZKEAgQn-Lj8pT-oTEP3D4Bdxc-va_7sSj8bmyxLKINVfvUnB-lNV8hBhyWvKUdAH7IsoTjrbmKXTDH_AWwlotLpAKUSw-kEvgDpuI80bmB9_mmdeEiqwz9EeMDSo9_Pj17q_Yq5mN_sGexAiR9X-xLDK-uyaOaLJt6uvBy63AHvSdDdul4PCh6uA-BC0iVtzB.L5GrAYToImxHy109gwCKdm1zR12p9T5Mv05EcoxPV4g"}

Headers = {"Authorization": "Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNyc2Etb2FlcCIsImVuYyI6IkEyNTZDQkMtSFM1MTIiLCJraWQiOiJFMUIzRDc0NDY4MTUyNzE2MDY2NUI5NUExQ0Y2OTAzMzc5MDZBN0ZEIiwidHlwIjoiSldUIn0.1KByK9SlDj4Pzfg9fEZ9U92WMXIHUIEh24IparXUn-6cyvqconcnyebbWXLUMc5zj_P-OG9OdmKhUSBCuW0Q10YM7hJxAhcAhz9pyZxzmJJfCoULAA60MITrxxMsUsXk7tlRwrTSxhfTAtfQVk_bnzD0z1iVxMIYE7fejshKVTYV_FUw1jXHD1me-momU9UfYrw7Pv6aqAQTuh2_nsq80MrtlbX3ML4Nx7ZHIqr_oAriVuR-Ti_Jibp9LGv5FT9O4sbvMTZNrC3-mB69TK0o4SdTNgS11WGllVgbzgC4NGFLlZ4Suh8TFW1vxer9YbFJcSPJDFNk0lRp9DmcLAOq7g.y5Wdmz3rbkvzHyJiJBBnXg.KcZ7-zjCd5vy4zPrPZNnTd0qo1TR71vXcWSIDb5QmAYJYbDdcFnFsi1uxqVJRi2mJfDfFBef6rVBVXduo4WM1ohA3SvLCeO_B_Ef6r3UcgNT_V7388cIE_7jvXsim5rDhvbZ2Uilk124ffZcQBTiinL4vWrSsZcLyrL1qOwgiOrjN_oOPyHK4IlI7ID-p6nkVedc8Dy8GWNYoryTocLB8vuQFQM82quZ4sxssY3GSbL3TuiRKJtASrSrQ_ebPeibh5dz_IBeVwtI8QRM4wImsnyvcdl-Gqj-m9M2oG9vtVSbNcsfIbjcsq7i3BuWQkWHwaqsG2RQMNXJShmXZb2tKz28mGMQQtdv0dnSsWUE04GJuSy1VsyZhSeakZaaLB2yt3-vvxe6-cSwKnfqcWoIrsoQuwusw_WLJ0eDOc4VOKsPc0QN80fJQOIIJ3mpQmSZbFcSIXOr17EmoEISuUhMA0FUuqxY7tOelH6UNsCqoNIY3DASFHCgx0b2r32P72V2WstKsYRIbNMOd6ZX80zEaPNdB4oa1-8EpNgpcjv6HiAZg4P0jyRnIMXU4Qc2jFxFyMJ7JGT9NvH6oKha5tyTyivpaCmQmzeo1Tbl1QA9nl9Lv2g_GCV0Am0V3bcPGUc7VnfH4pZZLRomVHbNEeAnINAiNS4sBbFcB2xqy1JpJYF6mWtJEnVZqBF7HJrQ87cFAtFs7MjkxaSoUckqwXwA2RzjcZGD5xWE07MJtwYU4FzD1khKYkwcoNJa5fGVr-NJa60QO20c0wIvJklFwcfu3F8Rvu29cDNttRbE3Y0nk8p8Vo_h117VtHyfnGGxQ_-DyA5ggYaCnxegdYyEh2OlaRTwsvopAaDNE8lNXWaK4mBBjHLeRCy5m4UY5zDnUByG8WHAA3P6KoSL9qJUhWZNIF3N13lXczu_HrrekDlXxzA1EZMxjduJjKCFlxdDuhJID7IuonMGHKvBdRrtmn2dpxmKVvtQ-3JfcQ-urLYcUCj5sG98fzFFRxN78yE-yMjklDCiYn53apvuD4ZKZ4N9PrCJJIi9OMi6rAd25jwVku_2KYJOEPnEbieLr1-NwkXYJsW9Lh1CT4EJCqHnPdPsqrHxkRuCrYOHDSpHLCrVDVdM3Y2usO-OOlXm6yZbols6.BEqYl4RFHc1uN60bGfq5_zD9DXw5OP5NU240HiMbMRE"}

url = "https://s116350.mobicontrolcloud.com/MobiControl/api/devices?take=10000"

response = requests.get(
          url,
          headers=Headers
        )

jsondata = response.json()
print(jsondata)

data_file = open('C:/Users/vd.gokkulkumar/Desktop/important/marvex_data_play/jsonoutput.csv', 'w', newline='')
csv_writer = csv.writer(data_file)

count = 0
for data in jsondata:
    if count == 0:
        header = data.keys()
        csv_writer.writerow(header)
        count += 1
    csv_writer.writerow(data.values())

data_file.close()

# df = pd.json_normalize(data['type'])


# -----------------------------------------------

